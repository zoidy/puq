<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Calibration of Input Variables &mdash; PUQ 2.2.2 documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.2.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="PUQ 2.2.2 documentation" href="../index.html" />
    <link rel="up" title="User’s Guide and Tutorial" href="../users_guide.html" />
    <link rel="next" title="Sensitivity Analysis" href="sensitivity.html" />
    <link rel="prev" title="Callbacks" href="callbacks.html" /> 
  </head>
  <body>

<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
<a href="../index.html"><img src="../_static/logo.png" border="0" alt="py4sci"/></a>
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="sensitivity.html" title="Sensitivity Analysis"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="callbacks.html" title="Callbacks"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">home</a>|&nbsp;</li>
        <li><a href="../search.html">search</a>|&nbsp;</li>
       <li><a href="../index.html">documentation </a> &raquo;</li>

          <li><a href="../users_guide.html" accesskey="U">User&#8217;s Guide and Tutorial</a> &raquo;</li> 
      </ul>
    </div>

      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Calibration of Input Variables</a><ul>
<li><a class="reference internal" href="#using-puq-for-calibration">Using PUQ for Calibration</a></li>
<li><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="callbacks.html"
                        title="previous chapter">Callbacks</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="sensitivity.html"
                        title="next chapter">Sensitivity Analysis</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/ug/calibration.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="calibration-of-input-variables">
<h1>Calibration of Input Variables<a class="headerlink" href="#calibration-of-input-variables" title="Permalink to this headline">¶</a></h1>
<p>Frequently computer models will have input parameters that cannot be measured and are not well known.
In this case, Bayesian calibration can be used to estimate the input parameters.  To do this,
experimental data is required for the output and for all known input variables.  The calibration process
adjusts the unknown parameters to fit the observed data.</p>
<div class="section" id="using-puq-for-calibration">
<h2>Using PUQ for Calibration<a class="headerlink" href="#using-puq-for-calibration" title="Permalink to this headline">¶</a></h2>
<p>To use PUQ to do calibration, you will have to add experimental data to all the known
input parameters.  For the TestProgram, you will need to add experimental data and (optionally)
a measurement error.  The measurement error is a standard deviation.</p>
<p>The presence of experimental data tells PUQ to do calibration.  The steps are as follows:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Build a response surface over the range of the input paramaters.</li>
<li>Do Bayesian calibration using the response surface for the likelihood function.</li>
<li>Manually adjust calibrated input parameter PDFs, if necessary.  For example,  truncate PDFs that go negative.</li>
<li>Generate output PDF.</li>
</ol>
</div></blockquote>
</div>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<p>test2 in puq/examples/calibrate calibrates <em>z</em>.  The experimental data was generated using a
<em>z</em> with a Normal distribution of 12 and deviation of 2.  Some noise was added with a sigma of
0.1.  For calibration we use a uniform prior [5, 20] for <em>z</em>.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">puq</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">run</span><span class="p">():</span>

    <span class="c"># experimental data for z=Normal(12,2)</span>
    <span class="n">exp_x</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">5.04</span><span class="p">,</span>  <span class="mf">5.14</span><span class="p">,</span>  <span class="mf">4.78</span><span class="p">,</span>  <span class="mf">5.12</span><span class="p">,</span>  <span class="mf">5.11</span><span class="p">,</span>  <span class="mf">5.13</span><span class="p">,</span>  <span class="mf">4.97</span><span class="p">,</span>  <span class="mf">5.1</span> <span class="p">,</span>  <span class="mf">5.53</span><span class="p">,</span>  <span class="mf">5.09</span><span class="p">])</span>
    <span class="n">exp_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">3.33</span><span class="p">,</span>  <span class="mf">3.56</span><span class="p">,</span>  <span class="mf">2.94</span><span class="p">,</span>  <span class="mf">3.27</span><span class="p">,</span>  <span class="mf">3.54</span><span class="p">,</span>  <span class="mf">3.4</span> <span class="p">,</span>  <span class="mf">3.52</span><span class="p">,</span>  <span class="mf">3.63</span><span class="p">,</span>  <span class="mf">3.45</span><span class="p">,</span>  <span class="mf">3.19</span><span class="p">])</span>
    <span class="n">exp_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">26.16</span><span class="p">,</span> <span class="o">-</span><span class="mf">18.39</span><span class="p">,</span> <span class="o">-</span><span class="mf">20.57</span><span class="p">,</span> <span class="o">-</span><span class="mf">45.24</span><span class="p">,</span> <span class="o">-</span><span class="mf">29.16</span><span class="p">,</span> <span class="o">-</span><span class="mf">22.</span><span class="p">,</span> <span class="o">-</span><span class="mf">46.47</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.15</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.48</span><span class="p">,</span> <span class="o">-</span><span class="mf">16.88</span><span class="p">])</span>

    <span class="c"># measurement error</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="mf">0.1</span>

    <span class="c"># Create parameters. Pass experimental input data to</span>
    <span class="c"># non-calibration parameters.</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">puq</span><span class="o">.</span><span class="n">NormalParameter</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">dev</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">caldata</span><span class="o">=</span><span class="n">exp_x</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">puq</span><span class="o">.</span><span class="n">NormalParameter</span><span class="p">(</span><span class="s">&#39;y&#39;</span><span class="p">,</span> <span class="s">&#39;y&#39;</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mf">3.4</span><span class="p">,</span> <span class="n">dev</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">caldata</span><span class="o">=</span><span class="n">exp_y</span><span class="p">)</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">puq</span><span class="o">.</span><span class="n">UniformParameter</span><span class="p">(</span><span class="s">&#39;z&#39;</span><span class="p">,</span> <span class="s">&#39;z&#39;</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

    <span class="c"># set up host, uq and prog normally</span>
    <span class="n">host</span> <span class="o">=</span> <span class="n">puq</span><span class="o">.</span><span class="n">InteractiveHost</span><span class="p">()</span>
    <span class="n">uq</span> <span class="o">=</span> <span class="n">puq</span><span class="o">.</span><span class="n">Smolyak</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">],</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">prog</span> <span class="o">=</span> <span class="n">puq</span><span class="o">.</span><span class="n">TestProgram</span><span class="p">(</span><span class="s">&#39;./model_1.py&#39;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s">&#39;model_1 calibration&#39;</span><span class="p">)</span>

    <span class="c"># pass experimental results to Sweep</span>
    <span class="k">return</span> <span class="n">puq</span><span class="o">.</span><span class="n">Sweep</span><span class="p">(</span><span class="n">uq</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">prog</span><span class="p">,</span> <span class="n">caldata</span><span class="o">=</span><span class="n">exp_data</span><span class="p">,</span> <span class="n">calerr</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="highlight-python"><div class="highlight"><pre>~/puq/examples/calibrate&gt; puq start test2.py
Saving run to sweep_85212814.hdf5

Processing &lt;HDF5 dataset &quot;f&quot;: shape (25,), type &quot;&lt;f8&quot;&gt;
        Surface   = 1.0*x**2 + 1.0*x*y + 0.75*y**2 + 2.0*y - 7.0*z + 2.0
        RMSE      = 2.15e-11 (1.74e-11 %)

SENSITIVITY:
Var      u*            dev
-----------------------------
z    1.0500e+02    1.8394e-11
y    1.8630e+01    1.1297e+00
x    1.6505e+01    1.0054e+00
Performing Bayesian Calibration...
[****************100%******************]  12000 of 12000 complete
Calibrated z to Normal(12.0786402402, 2.2152608414).
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="sensitivity.html" title="Sensitivity Analysis"
             >next</a> |</li>
        <li class="right" >
          <a href="callbacks.html" title="Callbacks"
             >previous</a> |</li>
        <li><a href="../index.html">home</a>|&nbsp;</li>
        <li><a href="../search.html">search</a>|&nbsp;</li>
       <li><a href="../index.html">documentation </a> &raquo;</li>

          <li><a href="../users_guide.html" >User&#8217;s Guide and Tutorial</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, Martin Hunt, Purdue University.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.1.
    </div>
  </body>
</html>